---
title: Analysis of Variance
author: Fiona Seaton
date: 2018-03-28

draft: false
toc: false
type: docs

linktitle: ANOVAs
menu:
  tutorial:
    parent: Modelling
    weight: 6
---



<p>This tutorial is the second part of the introduction to simple linear regression in R, the use of ANOVAs with categorical predictors.</p>
<p>First we’re going to load in all the packages we’ll be using in this analysis.</p>
<pre class="r"><code>library(agridat)          # a package of agricultural datasets
library(summarytools)     # useful functions for summarising datasets
library(dplyr)            # manipulating data
library(ggplot2)          # plotting
library(gridExtra)        # plotting in panels
library(car)              # extensions for regression
library(AICcmodavg)       # calculates AICc</code></pre>
<p>As we’re plotting with ggplot I’m going to set the theme now for the whole tutorial to make it look nicer to me - see the plotting tutorial for more information on the plotting commands.</p>
<pre class="r"><code>theme_set(theme_bw() + theme(panel.grid = element_blank()))</code></pre>
<p>We’re going to be using the apples data from the agridat package, an experiment from the 1980s on the impact of spacing, root stock and cultivars on apple tree yields. We’ll be focusing on the impact of spacing, which came in three different treatments: 6m, 10m and 14m apart.</p>
<pre class="r"><code>apples &lt;- agridat::archbold.apple
head(apples)</code></pre>
<pre><code>##   rep row pos spacing    stock     gen yield trt
## 1  R1   2   1       6 Seedling Redspur  70.9 601
## 2  R1   2   2       6 Seedling  Golden 130.9 602
## 3  R1   2   8       6    MM111 Redspur 114.5 611
## 4  R1   2   7       6    MM111  Golden  90.5 612
## 5  R1   2   3       6    M0007 Redspur 151.8 671
## 6  R1   2   4       6    M0007  Golden 125.0 672</code></pre>
<pre class="r"><code>str(apples)</code></pre>
<pre><code>## &#39;data.frame&#39;:    120 obs. of  8 variables:
##  $ rep    : Factor w/ 5 levels &quot;R1&quot;,&quot;R2&quot;,&quot;R3&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ row    : int  2 2 2 2 2 2 2 2 2 2 ...
##  $ pos    : int  1 2 8 7 3 4 5 6 16 12 ...
##  $ spacing: int  6 6 6 6 6 6 6 6 10 10 ...
##  $ stock  : Factor w/ 4 levels &quot;M0007&quot;,&quot;MM106&quot;,..: 4 4 3 3 1 1 2 2 3 1 ...
##  $ gen    : Factor w/ 2 levels &quot;Golden&quot;,&quot;Redspur&quot;: 2 1 2 1 2 1 2 1 2 2 ...
##  $ yield  : num  70.9 130.9 114.5 90.5 151.8 ...
##  $ trt    : int  601 602 611 612 671 672 661 662 1011 1071 ...</code></pre>
<pre class="r"><code>print(dfSummary(apples), method = &quot;render&quot;)</code></pre>
<div class="container st-container">
<h3>Data Frame Summary  </h3>
<h4>apples</h4>
<strong>N</strong>: 120
<table class="table table-striped table-bordered st-table st-table-striped st-table-bordered st-multiline ">
  <thead>
    <tr>
      <th align="center"><strong>No</strong></th>
      <th align="center"><strong>Variable</strong></th>
      <th align="center"><strong>Stats / Values</strong></th>
      <th align="center"><strong>Freqs (% of Valid)</strong></th>
      <th align="center"><strong>Graph</strong></th>
      <th align="center"><strong>Valid</strong></th>
      <th align="center"><strong>Missing</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td align="center">1</td>
      <td align="left">rep
[factor]</td>
      <td align="left">1. R1
2. R2
3. R3
4. R4
5. R5</td>
      <td align="left">24 (20.0%)
24 (20.0%)
24 (20.0%)
24 (20.0%)
24 (20.0%)</td>
      <td align="center" border="0"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACCCAMAAACTmMFdAAAADFBMVEX9/v2mpqb39/f9/v0TNkn1AAAABHRSTlP///8AQCqp9AAAAMhJREFUeJzt16EBw0AQxEAn7r/npIAnQr9gpgKBO7DPO+m5HXAmq5jN+iz6Z333yCpkFbIKWYWsQlYhq5BVyCqGsxbNDrJJs1m3z+ho9xNvNxzIKmQVsgpZhaxCViGrkFUMZy2aXT6TZrNun9HR7ifebjiQVcgqZBWyClmFrEJWIauQVZiviaxi9rZWP/F2w4GsQlYhq5BVyCpkFbIKWYWswnxNZBWzt7X6ibcbDmQVsgpZhaxCViGrkFXIKoazFs0un0myitGsHzIonxNxzvqnAAAAAElFTkSuQmCC"></td>
      <td align="center">120
(100%)</td>
      <td align="center">0
(0%)</td>
    </tr>
    <tr>
      <td align="center">2</td>
      <td align="left">row
[integer]</td>
      <td align="left">mean (sd) : 9.02 (4.39)
min &lt; med &lt; max :
2 &lt; 9 &lt; 16
IQR (CV) : 7.25 (0.49)</td>
      <td align="left">15 distinct values</td>
      <td align="center" border="0"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAABkCAMAAABThTnCAAAADFBMVEX9/v2mpqby8vL9/v28xacEAAAABHRSTlP///8AQCqp9AAAAJ1JREFUaIHt1kEKgCAQQFGr+9+5RZsglbHABnl/Gei8QMRypKz8DaiHNdLF2molYO3PsLCwsLCwsLCwsJZljb3L57GGRmDNZQXPzHRWbCkWFtZSrPcXUpjVHNFhBX/vC6s5AgsLq7emVgJW7BvWCqzYEZzO+rIdFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhZWMlaibqx0YY2UlHUC8vmIRnQLcnoAAAAASUVORK5CYII="></td>
      <td align="center">120
(100%)</td>
      <td align="center">0
(0%)</td>
    </tr>
    <tr>
      <td align="center">3</td>
      <td align="left">pos
[integer]</td>
      <td align="left">mean (sd) : 9.24 (4.92)
min &lt; med &lt; max :
1 &lt; 10 &lt; 17
IQR (CV) : 9 (0.53)</td>
      <td align="left">17 distinct values</td>
      <td align="center" border="0"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAABkCAMAAABThTnCAAAADFBMVEX9/v2mpqby8vL9/v28xacEAAAABHRSTlP///8AQCqp9AAAAKdJREFUaIHt17sOwjAMBdAC///PDCyNUwWsVthSz139yBmyeHu1zFYNOA5WJh/WI2ZsWldjpmWp6YH1HBNZy+rEistS01hYWFhYWFhYWFhYt2N9uZOqWKluLKy/sX65/QtYy2EsLCwsrHaskC6sM2Wsu7GWn7iOdeG7WFhVrMOTo54Vu7GwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsHasRtmx2gUrk6asN1dog6HBNWo2AAAAAElFTkSuQmCC"></td>
      <td align="center">120
(100%)</td>
      <td align="center">0
(0%)</td>
    </tr>
    <tr>
      <td align="center">4</td>
      <td align="left">spacing
[integer]</td>
      <td align="left">mean (sd) : 10 (3.28)
min &lt; med &lt; max :
6 &lt; 10 &lt; 14
IQR (CV) : 8 (0.33)</td>
      <td align="left">6 : 40 (33.3%)
10 : 40 (33.3%)
14 : 40 (33.3%)</td>
      <td align="center" border="0"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAABOCAMAAAD1sh+SAAAADFBMVEX9/v2mpqb39/f9/v0TNkn1AAAABHRSTlP///8AQCqp9AAAAINJREFUaIHt16EBw0AQxEAn7r/npIAng36BpgKBO7DPO+m5HXA2m/VZ9M/67ilLlCXKEmWJskRZoixRlihLDGctmh1kk2azbp/R0e4n3m44KEuUJcoSZYmyRFmiLFGWKEs0X0lZYva2Vj/xdsNBWaIsUZYoS5QlyhJlibJEWaL5SsoSPwWqXr0bCZNHAAAAAElFTkSuQmCC"></td>
      <td align="center">120
(100%)</td>
      <td align="center">0
(0%)</td>
    </tr>
    <tr>
      <td align="center">5</td>
      <td align="left">stock
[factor]</td>
      <td align="left">1. M0007
2. MM106
3. MM111
4. Seedling</td>
      <td align="left">30 (25.0%)
30 (25.0%)
30 (25.0%)
30 (25.0%)</td>
      <td align="center" border="0"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAABoCAMAAAAkR/m5AAAADFBMVEX9/v2mpqb39/f9/v0TNkn1AAAABHRSTlP///8AQCqp9AAAAKhJREFUaIHt17ENwDAMxEAn3n/nZAA1rMSCNwEL2cCfq3S2A2ZlEec+Rn/W61MWURZRFlEWURZRFlEWURZRFiHOMtIOMiVt1vYZjbwvcbthUBZRFlEWURZRFlEWURZRFlEW0XxFyiK0t2V9idsNg7KIsoiyiLKIsoiyiLKIsghxlpF2+SiVRWhP3vpBbDcMyiLKIsoiyiLKIsoiyiLKIsRZRtrlo1QW8QGZ2X9/log28AAAAABJRU5ErkJggg=="></td>
      <td align="center">120
(100%)</td>
      <td align="center">0
(0%)</td>
    </tr>
    <tr>
      <td align="center">6</td>
      <td align="left">gen
[factor]</td>
      <td align="left">1. Golden
2. Redspur</td>
      <td align="left">60 (50.0%)
60 (50.0%)</td>
      <td align="center" border="0"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAA0CAMAAABfCzE1AAAADFBMVEX9/v2mpqb39/f9/v0TNkn1AAAABHRSTlP///8AQCqp9AAAAGJJREFUWIXt16EBADAIxEAo++/cDlATxYvcBBEgviZSbQf81XSil3XymEWYRZhFmEWYRZhFmEWYRZhFmEV07PKJZBYRe1upn7jd8GEWYRZhFmEWYRZhFmEWYRZhFuF8RUKzLroaPpLHM/aZAAAAAElFTkSuQmCC"></td>
      <td align="center">120
(100%)</td>
      <td align="center">0
(0%)</td>
    </tr>
    <tr>
      <td align="center">7</td>
      <td align="left">yield
[numeric]</td>
      <td align="left">mean (sd) : 145.4 (47.53)
min &lt; med &lt; max :
64.1 &lt; 147.05 &lt; 282.3
IQR (CV) : 68.3 (0.33)</td>
      <td align="left">85 distinct values</td>
      <td align="center" border="0"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAABkCAMAAABThTnCAAAADFBMVEX9/v2mpqby8vL9/v28xacEAAAABHRSTlP///8AQCqp9AAAAMtJREFUaIHt2kEOgyAQQFG1979zk25Ko8YOKEz0/ZWZDS9ugITplbJpNGA7rEg1rLnsdNGnKtbyDesorEhYkbAiYUXKxCr3wUysgoKF1YN1zYmwmXXNj8PCwsLCeixr3j77DWftrI+FVcXau+KMZh2vj4WFtfzezVqJZ7LKMRZWalbwvNeNVb8+FhYWFhYWFhbWEFbj5ewqVvmNhYWFhfUM1t97UmfW9hgL616sileFPVg7Yyysx7LWW2UO1mqMdR9WogpWurAiJWW9AYMnk+UFd//tAAAAAElFTkSuQmCC"></td>
      <td align="center">92
(76.67%)</td>
      <td align="center">28
(23.33%)</td>
    </tr>
    <tr>
      <td align="center">8</td>
      <td align="left">trt
[integer]</td>
      <td align="left">mean (sd) : 1036.5 (329.39)
min &lt; med &lt; max :
601 &lt; 1036.5 &lt; 1472
IQR (CV) : 735.5 (0.32)</td>
      <td align="left">24 distinct values</td>
      <td align="center" border="0"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAABkCAMAAABThTnCAAAADFBMVEX9/v2mpqby8vL9/v28xacEAAAABHRSTlP///8AQCqp9AAAAHZJREFUaIHtzjEOwCAMBEFM/v9nijSAUmAJKS5m+ztNe0rW/gZ8h5XpZcVe6uPqOGZWX0s+Xxx3LCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsrBNWoSZWubAyFWUN6uOanb7PknkAAAAASUVORK5CYII="></td>
      <td align="center">120
(100%)</td>
      <td align="center">0
(0%)</td>
    </tr>
  </tbody>
</table>
<p>Generated by <a href='https://github.com/dcomtois/summarytools'>summarytools</a> 0.8.8 (<a href='https://www.r-project.org/'>R</a> version 3.5.1)<br/>2018-11-22</p>
</div>
<p>So do apples that are closer together have lower yield? There are only 3 spacing values so we’ll convert it to a categorical variable using as.factor.</p>
<pre class="r"><code>apples$spacing2 &lt;- as.factor(apples$spacing)

ggplot(apples, aes(spacing2, yield)) +
    geom_boxplot() +
    labs(x = &quot;Spacing (m)&quot;, y = &quot;Yield (kg)&quot;)</code></pre>
<p><img src="/tutorial/ANOVA_0318_files/figure-html/apples%20spacing-1.png" width="672" /></p>
<p>Within R lm and aov give the same result with a single categorical predictor only difference is output of summary functions, which can be changed using summary.lm and summary.aov</p>
<p>now run linear model with lm to see if difference is statistically significant</p>
<pre class="r"><code>apples.m &lt;- lm(yield ~ spacing2, data = apples)
summary(apples.m)</code></pre>
<pre><code>## 
## Call:
## lm(formula = yield ~ spacing2, data = apples)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -92.389 -30.577  -3.516  33.192 117.628 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  120.566      7.382  16.332  &lt; 2e-16 ***
## spacing210    35.924     11.073   3.244 0.001659 ** 
## spacing214    44.107     10.966   4.022 0.000121 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 43.67 on 89 degrees of freedom
##   (28 observations deleted due to missingness)
## Multiple R-squared:  0.1742, Adjusted R-squared:  0.1556 
## F-statistic: 9.385 on 2 and 89 DF,  p-value: 0.0002003</code></pre>
<p>output gives the difference between the 10m spacing and the 6m spacing, and the 14m spacing and the 6m spacing. The 6m spacing is given by the intercept</p>
<p>use plots to examine residuals.</p>
<pre class="r"><code>par(mfrow=c(2,2));plot(apples.m);par(mfrow=c(1,1)) </code></pre>
<p><img src="/tutorial/ANOVA_0318_files/figure-html/apples%20diagnostics-1.png" width="672" /></p>
<pre class="r"><code>qqp(apples.m)</code></pre>
<p><img src="/tutorial/ANOVA_0318_files/figure-html/apples%20diagnostics-2.png" width="672" /></p>
<pre><code>## [1] 10 84</code></pre>
<p>If wish to do a Tukey’s HSD post-hoc test then need to fit model with aov rather than lm</p>
<pre class="r"><code>apples.aov &lt;- aov(yield ~ spacing2, data = apples)
summary(apples.aov)</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)    
## spacing2     2  35801   17900   9.385  2e-04 ***
## Residuals   89 169750    1907                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 28 observations deleted due to missingness</code></pre>
<pre class="r"><code>summary(apples.m) # compare to lm output - different format but same numbers</code></pre>
<pre><code>## 
## Call:
## lm(formula = yield ~ spacing2, data = apples)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -92.389 -30.577  -3.516  33.192 117.628 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  120.566      7.382  16.332  &lt; 2e-16 ***
## spacing210    35.924     11.073   3.244 0.001659 ** 
## spacing214    44.107     10.966   4.022 0.000121 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 43.67 on 89 degrees of freedom
##   (28 observations deleted due to missingness)
## Multiple R-squared:  0.1742, Adjusted R-squared:  0.1556 
## F-statistic: 9.385 on 2 and 89 DF,  p-value: 0.0002003</code></pre>
<pre class="r"><code>summary.lm(apples.aov) # can get equivalent output to lm using summary.lm</code></pre>
<pre><code>## 
## Call:
## aov(formula = yield ~ spacing2, data = apples)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -92.389 -30.577  -3.516  33.192 117.628 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  120.566      7.382  16.332  &lt; 2e-16 ***
## spacing210    35.924     11.073   3.244 0.001659 ** 
## spacing214    44.107     10.966   4.022 0.000121 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 43.67 on 89 degrees of freedom
##   (28 observations deleted due to missingness)
## Multiple R-squared:  0.1742, Adjusted R-squared:  0.1556 
## F-statistic: 9.385 on 2 and 89 DF,  p-value: 0.0002003</code></pre>
<pre class="r"><code>TukeyHSD(apples.aov)</code></pre>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = yield ~ spacing2, data = apples)
## 
## $spacing2
##            diff        lwr      upr     p adj
## 10-6  35.923571   9.530402 62.31674 0.0046832
## 14-6  44.106700  17.967561 70.24584 0.0003526
## 14-10  8.183128 -19.396838 35.76309 0.7598733</code></pre>
<div id="anova-with-unbalanced-designs-and-1-predictor" class="section level3">
<h3>ANOVA with unbalanced designs and &gt; 1 predictor</h3>
<p>Balanced designs have the same number of reps per treatment. This is often not the case, and the study is unbalanced. If the study is unbalanced the way in which predictors are evaluated impacts the result. The different ways of evaluating predictors are known as Type I, Type II and Type III ANOVAs</p>
<p>To find out more about this go to <a href="http://goanna.cs.rmit.edu.au/~fscholer/anova.php" class="uri">http://goanna.cs.rmit.edu.au/~fscholer/anova.php</a></p>
<p>For type III tests to be correct need to change the way R codes factors</p>
<pre class="r"><code>options(contrasts = c(&quot;contr.sum&quot;, &quot;contr.poly&quot;)) </code></pre>
<p>This won’t change type I or II Default is: options(contrasts = c(“contr.treatment”, “contr.poly”))</p>
<pre class="r"><code>A        = c(&quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;)
B        = c(&quot;x&quot;, &quot;y&quot;, &quot;x&quot;, &quot;y&quot;, &quot;x&quot;, &quot;y&quot;, &quot;x&quot;, &quot;y&quot;, &quot;x&quot;, &quot;x&quot;, &quot;x&quot;, &quot;x&quot;)
C        = c(&quot;l&quot;, &quot;l&quot;, &quot;m&quot;, &quot;m&quot;, &quot;l&quot;, &quot;l&quot;, &quot;m&quot;, &quot;m&quot;, &quot;l&quot;, &quot;l&quot;, &quot;l&quot;, &quot;l&quot;)
response = c( 14,  30,  15,  35,  50,  51,  30,  32,  51,  55,  53,  55)</code></pre>
<pre class="r"><code>model = lm(response ~ A + B + C + A:B + A:C + B:C)

anova(model)              # Type I tests</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: response
##           Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
## A          1 1488.37 1488.37 357.6869 7.614e-06 ***
## B          1   18.22   18.22   4.3798 0.0905765 .  
## C          1  390.15  390.15  93.7610 0.0001995 ***
## A:B        1  278.68  278.68  66.9722 0.0004431 ***
## A:C        1  339.51  339.51  81.5909 0.0002778 ***
## B:C        1    8.51    8.51   2.0444 0.2121592    
## Residuals  5   20.81    4.16                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>Anova(model, type=&quot;II&quot;)   # Type II tests using car package</code></pre>
<pre><code>## Anova Table (Type II tests)
## 
## Response: response
##            Sum Sq Df  F value    Pr(&gt;F)    
## A         1022.01  1 245.6103 1.923e-05 ***
## B          131.25  1  31.5421 0.0024764 ** 
## C          278.68  1  66.9722 0.0004431 ***
## A:B        180.01  1  43.2593 0.0012194 ** 
## A:C        321.01  1  77.1445 0.0003174 ***
## B:C          8.51  1   2.0444 0.2121592    
## Residuals   20.81  5                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>Anova(model, type=&quot;III&quot;)  # Type III tests using car package</code></pre>
<pre><code>## Anova Table (Type III tests)
## 
## Response: response
##             Sum Sq Df   F value    Pr(&gt;F)    
## (Intercept) 9490.0  1 2280.6425 7.605e-08 ***
## A            724.5  1  174.1138 4.465e-05 ***
## B            184.5  1   44.3408 0.0011526 ** 
## C            180.0  1   43.2593 0.0012194 ** 
## A:B          180.0  1   43.2593 0.0012194 ** 
## A:C          321.0  1   77.1445 0.0003174 ***
## B:C            8.5  1    2.0444 0.2121592    
## Residuals     20.8  5                        
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Balanced design shows no difference between type I, II and III</p>
<pre class="r"><code>A        = c(&quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;)
B        = c(&quot;x&quot;, &quot;y&quot;, &quot;x&quot;, &quot;y&quot;, &quot;x&quot;, &quot;y&quot;, &quot;x&quot;, &quot;y&quot;, &quot;x&quot;, &quot;y&quot;, &quot;x&quot;, &quot;y&quot;)
C        = c(&quot;l&quot;, &quot;l&quot;, &quot;m&quot;, &quot;m&quot;, &quot;l&quot;, &quot;l&quot;, &quot;m&quot;, &quot;m&quot;, &quot;l&quot;, &quot;l&quot;, &quot;m&quot;, &quot;m&quot;)
response = c( 14,  30,  15,  35,  50,  51,  30,  32,  51,  55,  53,  55)</code></pre>
<pre class="r"><code>model = lm(response ~ A + B + C + A:B + A:C + B:C)

anova(model)              # Type I tests</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: response
##           Df  Sum Sq Mean Sq F value Pr(&gt;F)
## A          1  546.75  546.75  1.9146 0.2250
## B          1  168.75  168.75  0.5909 0.4768
## C          1  315.38  315.38  1.1044 0.3414
## A:B        1   70.08   70.08  0.2454 0.6413
## A:C        1    0.38    0.38  0.0013 0.9725
## B:C        1   15.04   15.04  0.0527 0.8276
## Residuals  5 1427.87  285.57</code></pre>
<pre class="r"><code>Anova(model, type=&quot;II&quot;)   # Type II tests</code></pre>
<pre><code>## Anova Table (Type II tests)
## 
## Response: response
##            Sum Sq Df F value Pr(&gt;F)
## A          782.04  1  2.7385 0.1589
## B          168.75  1  0.5909 0.4768
## C          315.38  1  1.1044 0.3414
## A:B         84.37  1  0.2955 0.6101
## A:C          0.38  1  0.0013 0.9725
## B:C         15.04  1  0.0527 0.8276
## Residuals 1427.87  5</code></pre>
<pre class="r"><code>Anova(model, type=&quot;III&quot;)  # Type III tests </code></pre>
<pre><code>## Anova Table (Type III tests)
## 
## Response: response
##              Sum Sq Df F value    Pr(&gt;F)    
## (Intercept) 16380.4  1 57.3593 0.0006367 ***
## A             782.0  1  2.7385 0.1588624    
## B             168.7  1  0.5909 0.4767865    
## C             315.4  1  1.1044 0.3414277    
## A:B            84.4  1  0.2955 0.6100929    
## A:C             0.4  1  0.0013 0.9724954    
## B:C            15.0  1  0.0527 0.8275710    
## Residuals    1427.9  5                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The choice between the types of ANOVAs is beyond the scope of this R club and is hypothesis dependent.</p>
</div>
